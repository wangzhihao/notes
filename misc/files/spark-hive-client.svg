<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentScriptType="application/ecmascript" contentStyleType="text/css" height="838px" preserveAspectRatio="none" style="width:1427px;height:838px;" version="1.1" viewBox="0 0 1427 838" width="1427px" zoomAndPan="magnify"><defs><filter height="300%" id="f173kcpzjfmx56" width="300%" x="-1" y="-1"><feGaussianBlur result="blurOut" stdDeviation="2.0"/><feColorMatrix in="blurOut" result="blurOut2" type="matrix" values="0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 0 .4 0"/><feOffset dx="4.0" dy="4.0" in="blurOut2" result="blurOut3"/><feBlend in="SourceGraphic" in2="blurOut3" mode="normal"/></filter></defs><g><!--cluster org.apache.hadoop.hive.ql.metadata--><polygon fill="#FFFFFF" filter="url(#f173kcpzjfmx56)" points="171.25,700,429.25,700,436.25,722.29,440.25,722.29,440.25,826,171.25,826,171.25,700" style="stroke: #000000; stroke-width: 1.5;"/><line style="stroke: #000000; stroke-width: 1.5;" x1="171.25" x2="436.25" y1="722.29" y2="722.29"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacingAndGlyphs" textLength="252" x="175.25" y="715.3369">org.apache.hadoop.hive.ql.metadata</text><!--class Hive--><rect fill="#FEFECE" filter="url(#f173kcpzjfmx56)" height="73.5986" id="Hive" style="stroke: #A80036; stroke-width: 1.5;" width="179" x="216" y="736"/><ellipse cx="288.75" cy="752" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M292.5781,757.6563 Q290.7031,758.3125 288.8906,758.3125 Q286.2969,758.3125 284.7109,756.5313 Q283.125,754.75 283.125,751.8438 Q283.125,749.1563 284.5313,747.3906 Q285.3906,746.3125 286.5078,745.8594 Q287.625,745.4063 289.4063,745.4063 Q291.125,745.4063 292.5781,745.7656 L292.5781,747.75 Q290.7031,747.0469 289.4531,747.0469 Q287.7656,747.0469 286.7734,748.3672 Q285.7813,749.6875 285.7813,751.9219 Q285.7813,753.9688 286.8203,755.2656 Q287.8594,756.5625 289.5,756.5625 Q290.8906,756.5625 292.5781,755.7813 L292.5781,757.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="25" x="309.25" y="756.4209">Hive</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="217" x2="394" y1="768" y2="768"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="217" x2="394" y1="776" y2="776"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="115" x="222" y="790.4521">public loadPartition();</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="167" x="222" y="803.2515">public loadDynamicPartitions();</text><!--class SparkSession--><rect fill="#FEFECE" filter="url(#f173kcpzjfmx56)" height="60.7993" id="SparkSession" style="stroke: #A80036; stroke-width: 1.5;" width="197" x="1030" y="130.5"/><ellipse cx="1086.75" cy="146.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1090.5781,152.1563 Q1088.7031,152.8125 1086.8906,152.8125 Q1084.2969,152.8125 1082.7109,151.0313 Q1081.125,149.25 1081.125,146.3438 Q1081.125,143.6563 1082.5313,141.8906 Q1083.3906,140.8125 1084.5078,140.3594 Q1085.625,139.9063 1087.4063,139.9063 Q1089.125,139.9063 1090.5781,140.2656 L1090.5781,142.25 Q1088.7031,141.5469 1087.4531,141.5469 Q1085.7656,141.5469 1084.7734,142.8672 Q1083.7813,144.1875 1083.7813,146.4219 Q1083.7813,148.4688 1084.8203,149.7656 Q1085.8594,151.0625 1087.5,151.0625 Q1088.8906,151.0625 1090.5781,150.2813 L1090.5781,152.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="75" x="1107.25" y="150.9209">SparkSession</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1031" x2="1226" y1="162.5" y2="162.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="185" x="1036" y="176.9521">lazy val sessionState: SessionState;</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="1031" x2="1226" y1="183.2993" y2="183.2993"/><!--class SparkSession.Builder--><rect fill="#FEFECE" filter="url(#f173kcpzjfmx56)" height="60.7993" id="SparkSession.Builder" style="stroke: #A80036; stroke-width: 1.5;" width="439" x="909" y="8.5"/><ellipse cx="1064.75" cy="24.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1068.5781,30.1563 Q1066.7031,30.8125 1064.8906,30.8125 Q1062.2969,30.8125 1060.7109,29.0313 Q1059.125,27.25 1059.125,24.3438 Q1059.125,21.6563 1060.5313,19.8906 Q1061.3906,18.8125 1062.5078,18.3594 Q1063.625,17.9063 1065.4063,17.9063 Q1067.125,17.9063 1068.5781,18.2656 L1068.5781,20.25 Q1066.7031,19.5469 1065.4531,19.5469 Q1063.7656,19.5469 1062.7734,20.8672 Q1061.7813,22.1875 1061.7813,24.4219 Q1061.7813,26.4688 1062.8203,27.7656 Q1063.8594,29.0625 1065.5,29.0625 Q1066.8906,29.0625 1068.5781,28.2813 L1068.5781,30.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="119" x="1085.25" y="28.9209">SparkSession.Builder</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="910" x2="1347" y1="40.5" y2="40.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="427" x="915" y="54.9521">private[this] val options = new scala.collection.mutable.HashMap[String, String];</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="910" x2="1347" y1="61.2993" y2="61.2993"/><!--class SparkContext--><rect fill="#FEFECE" filter="url(#f173kcpzjfmx56)" height="60.7993" id="SparkContext" style="stroke: #A80036; stroke-width: 1.5;" width="296" x="980.25" y="252.5"/><ellipse cx="1085.5" cy="268.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1089.3281,274.1563 Q1087.4531,274.8125 1085.6406,274.8125 Q1083.0469,274.8125 1081.4609,273.0313 Q1079.875,271.25 1079.875,268.3438 Q1079.875,265.6563 1081.2813,263.8906 Q1082.1406,262.8125 1083.2578,262.3594 Q1084.375,261.9063 1086.1563,261.9063 Q1087.875,261.9063 1089.3281,262.2656 L1089.3281,264.25 Q1087.4531,263.5469 1086.2031,263.5469 Q1084.5156,263.5469 1083.5234,264.8672 Q1082.5313,266.1875 1082.5313,268.4219 Q1082.5313,270.4688 1083.5703,271.7656 Q1084.6094,273.0625 1086.25,273.0625 Q1087.6406,273.0625 1089.3281,272.2813 L1089.3281,274.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="77" x="1106" y="272.9209">SparkContext</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="981.25" x2="1275.25" y1="284.5" y2="284.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="284" x="986.25" y="298.9521">private var _hadoopConfiguration: Configuration = _</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="981.25" x2="1275.25" y1="305.2993" y2="305.2993"/><!--class SparkHadoopUtil--><rect fill="#FEFECE" filter="url(#f173kcpzjfmx56)" height="86.3979" id="SparkHadoopUtil" style="stroke: #A80036; stroke-width: 1.5;" width="576" x="840.25" y="374"/><ellipse cx="1075.5" cy="390" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M1079.3281,395.6563 Q1077.4531,396.3125 1075.6406,396.3125 Q1073.0469,396.3125 1071.4609,394.5313 Q1069.875,392.75 1069.875,389.8438 Q1069.875,387.1563 1071.2813,385.3906 Q1072.1406,384.3125 1073.2578,383.8594 Q1074.375,383.4063 1076.1563,383.4063 Q1077.875,383.4063 1079.3281,383.7656 L1079.3281,385.75 Q1077.4531,385.0469 1076.2031,385.0469 Q1074.5156,385.0469 1073.5234,386.3672 Q1072.5313,387.6875 1072.5313,389.9219 Q1072.5313,391.9688 1073.5703,393.2656 Q1074.6094,394.5625 1076.25,394.5625 Q1077.6406,394.5625 1079.3281,393.7813 L1079.3281,395.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="97" x="1096" y="394.4209">SparkHadoopUtil</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="841.25" x2="1415.25" y1="406" y2="406"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="841.25" x2="1415.25" y1="414" y2="414"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="372" x="846.25" y="428.4521">private[spark] def newConfiguration(conf: SparkConf): Configuration;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="564" x="846.25" y="441.2515">private def appendS3AndSparkHadoopConfigurations(conf: SparkConf,hadoopConf: Configuration): Unit;</text><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="493" x="846.25" y="454.0508">private def appendSparkHadoopConfigs(conf: SparkConf, hadoopConf: Configuration): Unit;</text><!--class HiveClient--><rect fill="#FEFECE" filter="url(#f173kcpzjfmx56)" height="48" id="HiveClient" style="stroke: #A80036; stroke-width: 1.5;" width="89" x="338" y="520"/><ellipse cx="353" cy="536" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M356.8281,541.6563 Q354.9531,542.3125 353.1406,542.3125 Q350.5469,542.3125 348.9609,540.5313 Q347.375,538.75 347.375,535.8438 Q347.375,533.1563 348.7813,531.3906 Q349.6406,530.3125 350.7578,529.8594 Q351.875,529.4063 353.6563,529.4063 Q355.375,529.4063 356.8281,529.7656 L356.8281,531.75 Q354.9531,531.0469 353.7031,531.0469 Q352.0156,531.0469 351.0234,532.3672 Q350.0313,533.6875 350.0313,535.9219 Q350.0313,537.9688 351.0703,539.2656 Q352.1094,540.5625 353.75,540.5625 Q355.1406,540.5625 356.8281,539.7813 L356.8281,541.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="57" x="367" y="540.4209">HiveClient</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="339" x2="426" y1="552" y2="552"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="339" x2="426" y1="560" y2="560"/><!--class HiveClientImpl--><rect fill="#FEFECE" filter="url(#f173kcpzjfmx56)" height="48" id="HiveClientImpl" style="stroke: #A80036; stroke-width: 1.5;" width="114" x="248.25" y="628"/><ellipse cx="263.25" cy="644" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M267.0781,649.6563 Q265.2031,650.3125 263.3906,650.3125 Q260.7969,650.3125 259.2109,648.5313 Q257.625,646.75 257.625,643.8438 Q257.625,641.1563 259.0313,639.3906 Q259.8906,638.3125 261.0078,637.8594 Q262.125,637.4063 263.9063,637.4063 Q265.625,637.4063 267.0781,637.7656 L267.0781,639.75 Q265.2031,639.0469 263.9531,639.0469 Q262.2656,639.0469 261.2734,640.3672 Q260.2813,641.6875 260.2813,643.9219 Q260.2813,645.9688 261.3203,647.2656 Q262.3594,648.5625 264,648.5625 Q265.3906,648.5625 267.0781,647.7813 L267.0781,649.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="82" x="277.25" y="648.4209">HiveClientImpl</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="249.25" x2="361.25" y1="660" y2="660"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="249.25" x2="361.25" y1="668" y2="668"/><!--class IsolatedClientLoader--><rect fill="#FEFECE" filter="url(#f173kcpzjfmx56)" height="48" id="IsolatedClientLoader" style="stroke: #A80036; stroke-width: 1.5;" width="149" x="154" y="520"/><ellipse cx="169" cy="536" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M172.8281,541.6563 Q170.9531,542.3125 169.1406,542.3125 Q166.5469,542.3125 164.9609,540.5313 Q163.375,538.75 163.375,535.8438 Q163.375,533.1563 164.7813,531.3906 Q165.6406,530.3125 166.7578,529.8594 Q167.875,529.4063 169.6563,529.4063 Q171.375,529.4063 172.8281,529.7656 L172.8281,531.75 Q170.9531,531.0469 169.7031,531.0469 Q168.0156,531.0469 167.0234,532.3672 Q166.0313,533.6875 166.0313,535.9219 Q166.0313,537.9688 167.0703,539.2656 Q168.1094,540.5625 169.75,540.5625 Q171.1406,540.5625 172.8281,539.7813 L172.8281,541.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="117" x="183" y="540.4209">IsolatedClientLoader</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="155" x2="302" y1="552" y2="552"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="155" x2="302" y1="560" y2="560"/><!--class HiveUtils--><rect fill="#FEFECE" filter="url(#f173kcpzjfmx56)" height="60.7993" id="HiveUtils" style="stroke: #A80036; stroke-width: 1.5;" width="187" x="135" y="386.5"/><ellipse cx="199.75" cy="402.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M203.5781,408.1563 Q201.7031,408.8125 199.8906,408.8125 Q197.2969,408.8125 195.7109,407.0313 Q194.125,405.25 194.125,402.3438 Q194.125,399.6563 195.5313,397.8906 Q196.3906,396.8125 197.5078,396.3594 Q198.625,395.9063 200.4063,395.9063 Q202.125,395.9063 203.5781,396.2656 L203.5781,398.25 Q201.7031,397.5469 200.4531,397.5469 Q198.7656,397.5469 197.7734,398.8672 Q196.7813,400.1875 196.7813,402.4219 Q196.7813,404.4688 197.8203,405.7656 Q198.8594,407.0625 200.5,407.0625 Q201.8906,407.0625 203.5781,406.2813 L203.5781,408.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="49" x="220.25" y="406.9209">HiveUtils</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="136" x2="321" y1="418.5" y2="418.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="175" x="141" y="432.9521">//A tool to create new HiveClient</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="136" x2="321" y1="439.2993" y2="439.2993"/><!--class ExternalCatalog--><rect fill="#FEFECE" filter="url(#f173kcpzjfmx56)" height="48" id="ExternalCatalog" style="stroke: #A80036; stroke-width: 1.5;" width="122" x="167.25" y="137"/><ellipse cx="182.25" cy="153" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M186.0781,158.6563 Q184.2031,159.3125 182.3906,159.3125 Q179.7969,159.3125 178.2109,157.5313 Q176.625,155.75 176.625,152.8438 Q176.625,150.1563 178.0313,148.3906 Q178.8906,147.3125 180.0078,146.8594 Q181.125,146.4063 182.9063,146.4063 Q184.625,146.4063 186.0781,146.7656 L186.0781,148.75 Q184.2031,148.0469 182.9531,148.0469 Q181.2656,148.0469 180.2734,149.3672 Q179.2813,150.6875 179.2813,152.9219 Q179.2813,154.9688 180.3203,156.2656 Q181.3594,157.5625 183,157.5625 Q184.3906,157.5625 186.0781,156.7813 L186.0781,158.6563 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="90" x="196.25" y="157.4209">ExternalCatalog</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="168.25" x2="288.25" y1="169" y2="169"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="168.25" x2="288.25" y1="177" y2="177"/><!--class HiveExternalCatalog--><rect fill="#FEFECE" filter="url(#f173kcpzjfmx56)" height="60.7993" id="HiveExternalCatalog" style="stroke: #A80036; stroke-width: 1.5;" width="445" x="6" y="252.5"/><ellipse cx="166.75" cy="268.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M170.5781,274.1563 Q168.7031,274.8125 166.8906,274.8125 Q164.2969,274.8125 162.7109,273.0313 Q161.125,271.25 161.125,268.3438 Q161.125,265.6563 162.5313,263.8906 Q163.3906,262.8125 164.5078,262.3594 Q165.625,261.9063 167.4063,261.9063 Q169.125,261.9063 170.5781,262.2656 L170.5781,264.25 Q168.7031,263.5469 167.4531,263.5469 Q165.7656,263.5469 164.7734,264.8672 Q163.7813,266.1875 163.7813,268.4219 Q163.7813,270.4688 164.8203,271.7656 Q165.8594,273.0625 167.5,273.0625 Q168.8906,273.0625 170.5781,272.2813 L170.5781,274.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="115" x="187.25" y="272.9209">HiveExternalCatalog</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="450" y1="284.5" y2="284.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="7" x2="450" y1="292.5" y2="292.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="433" x="12" y="306.9521">lazy val client: HiveClient = { HiveUtils.newClientForMetadata(conf, hadoopConf) }</text><!--class HiveSessionStateBuilder--><rect fill="#FEFECE" filter="url(#f173kcpzjfmx56)" height="60.7993" id="HiveSessionStateBuilder" style="stroke: #A80036; stroke-width: 1.5;" width="670" x="324.25" y="130.5"/><ellipse cx="587.5" cy="146.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M591.3281,152.1563 Q589.4531,152.8125 587.6406,152.8125 Q585.0469,152.8125 583.4609,151.0313 Q581.875,149.25 581.875,146.3438 Q581.875,143.6563 583.2813,141.8906 Q584.1406,140.8125 585.2578,140.3594 Q586.375,139.9063 588.1563,139.9063 Q589.875,139.9063 591.3281,140.2656 L591.3281,142.25 Q589.4531,141.5469 588.2031,141.5469 Q586.5156,141.5469 585.5234,142.8672 Q584.5313,144.1875 584.5313,146.4219 Q584.5313,148.4688 585.5703,149.7656 Q586.6094,151.0625 588.25,151.0625 Q589.6406,151.0625 591.3281,150.2813 L591.3281,152.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="135" x="608" y="150.9209">HiveSessionStateBuilder</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="325.25" x2="993.25" y1="162.5" y2="162.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="658" x="330.25" y="176.9521">private def externalCatalog: HiveExternalCatalog = session.sharedState.externalCatalog.asInstanceOf[HiveExternalCatalog]</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="325.25" x2="993.25" y1="183.2993" y2="183.2993"/><!--class SessionState--><rect fill="#FEFECE" filter="url(#f173kcpzjfmx56)" height="60.7993" id="SessionState" style="stroke: #A80036; stroke-width: 1.5;" width="459" x="486" y="252.5"/><ellipse cx="676.25" cy="268.5" fill="#ADD1B2" rx="11" ry="11" style="stroke: #A80036; stroke-width: 1.0;"/><path d="M680.0781,274.1563 Q678.2031,274.8125 676.3906,274.8125 Q673.7969,274.8125 672.2109,273.0313 Q670.625,271.25 670.625,268.3438 Q670.625,265.6563 672.0313,263.8906 Q672.8906,262.8125 674.0078,262.3594 Q675.125,261.9063 676.9063,261.9063 Q678.625,261.9063 680.0781,262.2656 L680.0781,264.25 Q678.2031,263.5469 676.9531,263.5469 Q675.2656,263.5469 674.2734,264.8672 Q673.2813,266.1875 673.2813,268.4219 Q673.2813,270.4688 674.3203,271.7656 Q675.3594,273.0625 677,273.0625 Q678.3906,273.0625 680.0781,272.2813 L680.0781,274.1563 Z "/><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacingAndGlyphs" textLength="70" x="696.75" y="272.9209">SessionState</text><line style="stroke: #A80036; stroke-width: 1.5;" x1="487" x2="944" y1="284.5" y2="284.5"/><line style="stroke: #A80036; stroke-width: 1.5;" x1="487" x2="944" y1="292.5" y2="292.5"/><text fill="#000000" font-family="sans-serif" font-size="11" lengthAdjust="spacingAndGlyphs" textLength="447" x="492" y="306.9521">def newHadoopConf(hadoopConf: Configuration, sqlConf: SQLConf): Configuration</text><!--link SparkSession.Builder to SparkSession--><path d="M1128.25,69.663 C1128.25,86.394 1128.25,107.396 1128.25,124.938 " fill="none" id="SparkSession.Builder-SparkSession" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1128.25,130.262,1132.25,121.262,1128.25,125.262,1124.25,121.262,1128.25,130.262" style="stroke: #A80036; stroke-width: 1.0;"/><!--link SparkSession to SparkContext--><path d="M1128.25,191.663 C1128.25,208.394 1128.25,229.396 1128.25,246.938 " fill="none" id="SparkSession-SparkContext" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1128.25,252.262,1132.25,243.262,1128.25,247.262,1124.25,243.262,1128.25,252.262" style="stroke: #A80036; stroke-width: 1.0;"/><!--link SparkSession to SessionState--><path d="M1029.85,190.591 C967.184,208.799 886.02,232.382 821.829,251.033 " fill="none" id="SparkSession-SessionState" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="816.847,252.48,826.6058,253.8088,821.6483,251.0843,824.3727,246.1268,816.847,252.48" style="stroke: #A80036; stroke-width: 1.0;"/><!--link HiveSessionStateBuilder to SessionState--><path d="M673.093,191.663 C680.968,208.538 690.87,229.758 699.099,247.391 " fill="none" id="HiveSessionStateBuilder-SessionState" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="#A80036" points="701.372,252.262,701.1889,242.4148,699.2567,247.7315,693.9401,245.7993,701.372,252.262" style="stroke: #A80036; stroke-width: 1.0;"/><!--link HiveSessionStateBuilder to HiveExternalCatalog--><path d="M553.264,191.509 C488.404,209.567 405.519,232.644 339.684,250.974 " fill="none" id="HiveSessionStateBuilder-HiveExternalCatalog" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="334.574,252.397,344.3172,253.836,339.3907,251.0557,342.1711,246.1293,334.574,252.397" style="stroke: #A80036; stroke-width: 1.0;"/><!--link SparkContext to SparkHadoopUtil--><path d="M1128.25,313.623 C1128.25,329.882 1128.25,350.423 1128.25,368.831 " fill="none" id="SparkContext-SparkHadoopUtil" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="1128.25,373.961,1132.25,364.961,1128.25,368.961,1124.25,364.961,1128.25,373.961" style="stroke: #A80036; stroke-width: 1.0;"/><!--link HiveUtils to IsolatedClientLoader--><path d="M228.25,447.623 C228.25,467.903 228.25,494.638 228.25,514.642 " fill="none" id="HiveUtils-IsolatedClientLoader" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="228.25,519.834,232.25,510.834,228.25,514.834,224.25,510.834,228.25,519.834" style="stroke: #A80036; stroke-width: 1.0;"/><!--link HiveExternalCatalog to HiveUtils--><path d="M228.25,313.623 C228.25,333.664 228.25,360.213 228.25,381.252 " fill="none" id="HiveExternalCatalog-HiveUtils" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="228.25,386.475,232.25,377.475,228.25,381.475,224.25,377.475,228.25,386.475" style="stroke: #A80036; stroke-width: 1.0;"/><!--link ExternalCatalog to HiveExternalCatalog--><path d="M228.25,205.213 C228.25,220.761 228.25,237.943 228.25,252.106 " fill="none" id="ExternalCatalog-HiveExternalCatalog" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="221.25,205.137,228.25,185.137,235.25,205.137,221.25,205.137" style="stroke: #A80036; stroke-width: 1.0;"/><!--link IsolatedClientLoader to HiveClientImpl--><path d="M244.958,568 C256.783,584.279 272.697,606.187 285.206,623.408 " fill="none" id="IsolatedClientLoader-HiveClientImpl" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="288.309,627.678,286.2563,618.0454,285.3706,623.6325,279.7835,622.7469,288.309,627.678" style="stroke: #A80036; stroke-width: 1.0;"/><!--link HiveClient to HiveClientImpl--><path d="M353.444,584.656 C342.915,599.15 331.351,615.068 322.191,627.678 " fill="none" id="HiveClient-HiveClientImpl" style="stroke: #A80036; stroke-width: 1.0;"/><polygon fill="none" points="348.124,580.068,365.542,568,359.451,588.296,348.124,580.068" style="stroke: #A80036; stroke-width: 1.0;"/><!--link HiveClientImpl to Hive--><path d="M305.25,676.227 C305.25,691.683 305.25,712.421 305.25,730.647 " fill="none" id="HiveClientImpl-Hive" style="stroke: #A80036; stroke-width: 1.0; stroke-dasharray: 7.0,7.0;"/><polygon fill="#A80036" points="305.25,735.714,309.25,726.714,305.25,730.714,301.25,726.714,305.25,735.714" style="stroke: #A80036; stroke-width: 1.0;"/><!--
@startuml
package org.apache.hadoop.hive.ql.metadata {
	class Hive {
    	public loadPartition();
        public loadDynamicPartitions();
    }
}

class SparkSession {
	lazy val sessionState: SessionState;
}

class SparkSession.Builder {
 private[this] val options = new scala.collection.mutable.HashMap[String, String];
}

class SparkContext {
	private var _hadoopConfiguration: Configuration = _
}

class SparkHadoopUtil {
	private[spark] def newConfiguration(conf: SparkConf): Configuration;
    private def appendS3AndSparkHadoopConfigurations(conf: SparkConf,hadoopConf: Configuration): Unit;
    private def appendSparkHadoopConfigs(conf: SparkConf, hadoopConf: Configuration): Unit;
}

class HiveClient {

}

class HiveClientImpl {

}

class IsolatedClientLoader {

}


class HiveUtils {
	//A tool to create new HiveClient
}

class ExternalCatalog {

}
class HiveExternalCatalog {
    lazy val client: HiveClient = { HiveUtils.newClientForMetadata(conf, hadoopConf) }
}

class HiveSessionStateBuilder {
 private def externalCatalog: HiveExternalCatalog = session.sharedState.externalCatalog.asInstanceOf[HiveExternalCatalog]
}
class SessionState {
def newHadoopConf(hadoopConf: Configuration, sqlConf: SQLConf): Configuration
}
SparkSession.Builder ..> SparkSession
SparkSession ..> SparkContext
SparkSession ..> SessionState
HiveSessionStateBuilder - -> SessionState

HiveSessionStateBuilder ..> HiveExternalCatalog
SparkContext ..> SparkHadoopUtil
HiveUtils ..> IsolatedClientLoader
HiveExternalCatalog ..> HiveUtils
ExternalCatalog <|- - HiveExternalCatalog
IsolatedClientLoader ..> HiveClientImpl
HiveClient <|- - HiveClientImpl

HiveClientImpl ..> Hive
@enduml

PlantUML version 1.2018.06(Mon May 21 10:34:53 UTC 2018)
(GPLV2 source distribution)
Java Runtime: OpenJDK Runtime Environment
JVM: OpenJDK 64-Bit Server VM
Java Version: 1.8.0_192-b12
Operating System: Linux
OS Version: 4.9.124-0.1.ac.198.71.329.metal1.x86_64
Default Encoding: UTF-8
Language: en
Country: US
--></g></svg>